<div class="widget-box">
    <div class="widget-header">
      <h5 class="widget-title">
        Vulnerability Browser
      </h5>
    </div>
    <div class="widget-body">
        <div class="widget-main">
          <div class="input-group input-icon">
            <input ng-model="q" ng-enter="searchVulnerabilities()" id="nav-searchinput" class="form-control search-query" type="text"  autocomplete="off" placeholder="Search Vulnerabilities...">
            <i class="ace-icon fa fa-search nav-search-icon"></i>
            <span class="input-group-btn">
              <button class="btn btn-info btn-sm" type="button" ng-click="searchVulnerabilities()">
                Search
                <i class="ace-icon fa fa-search icon-on-right bigger-110"></i>
              </button>
            </span>
          </div>
          <div class="ciap_table_scroll_500">
            <table id="sample-table-1" class="table table-striped table-bordered table-hover dataTable">
              <thead>
              <tr role="row">
                <th class="sorting" ng-click="sort('title')">Title</th>
                <th class="sorting" ng-click="sort('description')">Description</th>
                <th class="sorting" ng-click="sort('cve_id')">CVE_ID</th>
                <th class="sorting" ng-click="sort('oscbd_id')">OSCBD_ID</th>
                <th class="ciap_width_10">Select</th>
              </tr>
              </thead>
              <tbody ng-hide="fetching">
                <tr ng-repeat="vulnerability in vulnerabilities">
                  <td><a href="#/vulnerabilities/{{vulnerability.guid | encodeURIComponent}}">{{vulnerability.title | prefixWithPortionMarking:vulnerability.portion_marking}}</a></td>
                  <td>{{vulnerability.description | prefixWithPortionMarking: vulnerability.portion_marking:vulnerability.description_c}}</td>
                  <td ng-if="vulnerability.title">
                    {{vulnerability.cve_id | prefixWithPortionMarking: vulnerability.portion_marking:vulnerability.cve_id_c}}
                  </td>
                  <td ng-if="!vulnerability.title">
                    <a href="#/vulnerabilities/{{vulnerability.guid | encodeURIComponent}}">{{vulnerability.cve_id | prefixWithPortionMarking: vulnerability.portion_marking:vulnerability.cve_id_c}}</a>
                  </td>
                  <td>{{vulnerability.osvdb_id | prefixWithPortionMarking: vulnerability.portion_marking:vulnerability.osvdb_id_c}}</td>
                  <td>
                    <input ng-disabled="disabled(vulnerability)" type="checkbox"
                           ng-click="selectVulnerability(vulnerability, $event)"
                           ng-checked="checked(vulnerability)"/>
                  </td>
                </tr>
              </tbody>
              <tbody ng-show="fetching">
                <tr>
                  <td colspan="5" class="center">
                    <i class="fa fa-spinner fa-spin bigger-300 blue"></i>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
    </div>
</div>
