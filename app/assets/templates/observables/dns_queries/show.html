<div class="page-header">
  <h1>
      {{dns_query.cybox_object_id}}
    <small ng-show="dns_query.read_only">
      <span class="ciap_mleft_10 label label-warning arrowed arrowed-right">
        <span class="white">Read Only</span>
      </span>
    </small>
    <small ng-show="dns_query.is_ciscp">
      <span class="ciap_mleft_10 label label-primary arrowed arrowed-right">
        <span class="white">CISCP</span>
      </span>
    </small>
    <small ng-show="dns_query.is_mifr">
      <span class="ciap_mleft_10 label label-primary arrowed arrowed-right">
        <span class="white">MIFR</span>
      </span>
    </small>    
    <span class="pull-right">
        <a ng-href="#/dns_queries/{{dns_query.cybox_object_id | encodeURIComponent}}/edit" class="btn btn-info no-radius btn-xs" ng-show="canModify(dns_query) && dns_query.read_only == false"><i class="ace-icon fa fa-pencil-square-o bigger-160"></i> Edit</a>
    </span>
  </h1>
  <div class="space-18"></div>
  <span class="pull-left" ng-show="canAny(['create_remove_badge_status','view_badge_status'])">
    <badge-statuses-table badge-statuses="dns_query.badge_statuses" audits="dns_query.audits" parent-id="dns_query.guid" parent-class="DnsQuery"></badge-statuses-table>
  </span>
  <div class="space-18"></div>
</div>

<div class="profile-user-info profile-user-info-striped">
  <div class="profile-info-row">
    <div class="profile-info-name"> Cybox Object ID </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
          <span>{{dns_query.cybox_object_id | prefixWithPortionMarking: dns_query.portion_marking}}</span>
      </div>
    </div>
  </div>
  
  <div class="profile-info-row" ng-show='dns_query.feeds'>
    <div class="profile-info-name"> Disseminated Feeds </div>
    <div class="profile-info-value">
      <span>{{dns_query.feeds}}</span>
    </div>
  </div>  

  <div class="profile-info-row">
    <div class="profile-info-name"> Questions </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
          <span>{{dns_query.question_normalized_cache}}</span>
      </div>
    </div>
  </div>

  <div class="profile-info-row">
    <div class="profile-info-name"> Answer Resource Records </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
          <span>{{dns_query.answer_normalized_cache}}</span>
      </div>
    </div>
  </div>

  <div class="profile-info-row">
    <div class="profile-info-name"> Authority Resource Records </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
          <span>{{dns_query.authority_normalized_cache}}</span>
      </div>
    </div>
  </div>

  <div class="profile-info-row">
    <div class="profile-info-name"> Additional Records </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
          <span>{{dns_query.additional_normalized_cache}}</span>
      </div>
    </div>
  </div>

  <div class="profile-info-row">
    <div class="profile-info-name"> Created 
    	<span class="ace-icon ciap_fa_icon_sm fa-stack" tooltip="Not Exportable Field">
    		<i class="fa fa-ban fa-stack-2x"> </i> 
 			  <i class="fa fa-download fa-stack-1x"> </i> 
    	</span>
    </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
        <span>{{dns_query.created_at | date:"medium"}}</span>
      </div>
    </div>
  </div>
  <div class="profile-info-row">
    <div class="profile-info-name"> Updated At 
      <span class="ace-icon ciap_fa_icon_sm fa-stack" tooltip="Not Exportable Field">
        <i class="fa fa-ban fa-stack-2x"> </i> 
        <i class="fa fa-download fa-stack-1x"> </i> 
      </span>
    </div>
    <div class="profile-info-value">
      <div class="ciap_show_table_formatting">
        <span>{{dns_query.updated_at | date:"medium"}}</span>
      </div>
    </div>
  </div>

  <div class="profile-info-row">
    <div class="profile-info-name"> Total Sightings </div>
    <div class="profile-info-value">
      <span>{{dns_query.total_sightings}}</span>
    </div>
  </div>
  <downgrade-request-ids observable="dns_query"></downgrade-request-ids>
</div>

<div ng-show="dns_query.stix_markings.length">
  <div class="space-12"></div>
  <markings-table markings="dns_query.stix_markings"></markings-table>
</div>

<div class="space-12" ng-show="dns_query.indicators.length"></div>
<div ng-show="dns_query.indicators.length">
  <indicator-table indicators="dns_query.indicators"></indicator-table>
</div>

<div class="space-12" ng-show="dns_query.course_of_actions.length"></div>
<course-of-actions-table course_of_actions="dns_query.course_of_actions" show_table=showTable addrelated="false" ng-show="dns_query.course_of_actions.length"></course-of-actions-table>

<div class="space-12" ng-show="dns_query.questions.length"></div>
<div ng-show="dns_query.questions.length">
  <question-table questions="dns_query.questions"></question-table>
</div>

<div class="space-12" ng-show="dns_query.resource_records.length"></div>
<div ng-show="dns_query.resource_records.length">
  <resource-record-table resource-records="dns_query.resource_records"></resource-record-table>
</div>

<div class="space-12" ng-show="dns_query.uris.length"></div>
<div ng-show="dns_query.uris.length">
  <uri-table uris="dns_query.uris"></uri-table>
</div>

<div class="space-12" ng-show="dns_query.dns_records.length"></div>
<div ng-show="dns_query.dns_records.length">
  <dns-record-table dns-records="dns_query.dns_records"></dns-record-table>
</div>

<div class="space-12" ng-show="dns_query.layer_seven_connections.length"></div>

<div ng-show="dns_query.layer_seven_connections.length">
  <layer-seven-connections-table layer-seven-connections="dns_query.layer_seven_connections"></layer-seven-connections-table>
</div>

<div ng-show="dns_query.stix_packages.length > 0">
  <div class="space-12"></div>
  <package-table packages="dns_query.stix_packages"></package-table>
</div>

<div class="space-12"></div>
<audits-table audits="dns_query.audits"></audits-table>

<div class="space-12"></div>
